# Code Documentation

Το παρόν έγγραφο προορίζεται για την διευκόλυνση της ανάγνωσης του codebase της εφαρμογής MyUoM και για άτομα που θα ήθελαν να βοηθήσουν γράφοντας κώδικα ή (φέρνοντας προβλήματα στην επιφάνεια.)

Περιεχόμενα:

- Βιβλιοθήκες Project
- Αρχιτεκτονική Εφαρμογής
- Δομή Φακέλων
- Quick Start Guide( start contributing )
- Coding Conventions
- Ανάλυση Κώδικα
  - Contexts
  - Hooks

### Βιβλιοθήκες project

Για το frontend χρησιμοποιήσαμε reactjs μαζί με την [Chakra UI](https://chakra-ui.com/) ως βιβλιοθήκη για έτοιμα components και styling(επιπλέον παρέχει διάφορα εργαλεία και μερικά icons).
Για τα animations χρησιμοποιήθηκε και η βιβλιοθήκη framer-motion(dependency της Chakra UI που μας χρειάστηκε επιπλέον). Για routing αξιοποιήθηκε η βιβλιοθήκη [react router dom v6](https://reactrouter.com/en/v6.3.0/getting-started/overview).
Η εφαρμογή ξεκίνησε με την χρήση [create-react-app](https://create-react-app.dev/) για λόγους ευκολίας(σύντομα όμως θα αλλαχτεί σε Vite.js, και typescript).
Για μερικά επιπλέον icons χρησιμοποιήθηκαν και οι βιβλιοθήκες [react-icons](https://react-icons.github.io/react-icons/) και [react-social-icons](https://www.npmjs.com/package/react-social-icons).

### Τρέξε τον κώδικα

Προς το παρόν επειδή είναι create-react-app, οι εντολές που χρειάζονται είναι οι εξής:
#### Με node
`git clone https://gitlab.com/opensourceuom/myUoM.git`
`cd app`
`npm install` (βάζει τις απαραίτητες βιβλιοθήκες εφόσον υπάρχει η node.js και το npm διαφορετικά θα χρειαστούν ξεχωριστά κατέβασμα αυτά)

`npm start` τρέχει την εφαρμογή στο localhost:3000, όταν θα γίνει η αλλαγή σε Vite.js θα είναι npm run dev
#### Με docker
`docker-compose up --build` (Για την port 80 στα linux χρειάζεται root)

### Αρχιτεκτονική Εφαρμογής

Η βασική δομή της εφαρμογής αποτελείται από το src/App.js το src/pages/HomePage.jsx και το src/assets/ConfigRoutes.js.
Πώς αλληλεπιδρούν όμως αυτά τα 3 αρχεία?

Ουσιαστικά στο `App.js` υπάρχουν τα routes(urls) που κάνουν render τα αντίστοιχα components. Κάθε σελίδα έχει το `Header.jsx` και ως αρχική σελίδα ορίζεται το `src/pages/HomePage.jsx`. Τώρα στο `src/pages/HomePage.jsx` τοποθετούνται τα πλακίδια στα οποία κάνει κλικ ο χρήστης και φτάνει στο αντίστοιχο component με βάση τα routes όπως αυτά έχουν οριστεί στο src/App.js. Το αρχείο ConfigRoutes.js όμως συνδέεται και με τα 2 άλλα αρχεία (App.js και HomePage.jsx) για να είναι ευκολότερη η προσθήκη νέων πλακιδίων στην αρχική σελίδα και να μην υπάρχει επανάληψη.

Πώς ξέρει όμως το `src/pages/HomePage.jsx` τι πλακίδια θα γίνουν render?

Στο `src/assets/ConfigRoutes.js` έχει οριστεί ένα array με objects τα οποία περιλαμβάνουν έναν τίτλο(**title**) ένα svg icon(**iconSVG**), το αντίστοιχο route στο οποίο πρέπει να σταλεί ο χρήστης όταν κάνει κλικ(για να γίνει render το αντίστοιχο component, όπως περιγράφεται παραπάνω) , ένα μέγεθος(**span**) το οποίο αξιοποιείται για να οριστεί το μέγεθος του πλακιδίου, μία λογική τιμή(**isExternal**) για να εμφανίζει στον χρήστη κατά πόσο θα παραμείνει στην εφαρμογή ή παραπέμπεται σε κάποια εξωτερική ιστοσελίδα(όπως υποδεικνύεται από το βέλος πάνω δεξιά στο πλακίδιο). Τέλος υπάρχει άλλη μία λογική τιμή (**requireSelection**) η οποία καθορίζει κατά πόσο το συγκεκριμένο πλακίδιο απαιτεί να έχει επιλεγεί σχολή(π.χ. το πρόγραμμα μαθημάτων/εξετάσεων είναι διαφορετικό ανά σχολή) και το σημαντικότερο το αντίστοιχο url στο οποίο στέλνεται ο χρήστης όταν κάνει κλικ(**route**). Επιπλέον υπάρχουν βοηθητικά πεδία, αν θέλουμε να κρύψουμε κάτι για συντήρηση και σε τι θέση να το βάλουμε.

Το πλακίδιο στο οποίο γίνεται αναφορά εδώ είναι το `src/components/MenuBox.jsx` το οποίο δέχεται ως props το object που μόλις αναλύθηκε από το `src/assets/ConfigRoutes.js`.

Περιληπτικά το `HomePage.jsx` κάνει render πολλά `MenuBox.jsx` με βάση το object array στο `ConfigRoutes.js` στα οποία κάνοντας κλικ ο χρήστης στέλνεται στο url του αντίστοιχου object το οποίο κάνει render το αντίστοιχο component με βάση την καταχώρηση στο `ConfigRoutes.js`.

### Δομή Φακέλων

Ο τρόπος που έχει δομηθεί η εφαρμογή σε φακέλους είναι αρκετά ευνόητος και συνηθίζεται σε μικρά react projects.
Ο φάκελος `src/assets` περιέχει στατικά δεδομένα(π.χ εικονες, link κλπ ) τα οποία μας χρειάζονται στην εφαρμογή(όπως δεδομένα κειμένου, icons και μεταφράσεις ).
Ο φάκελος `src/components` περιέχει react components που χρησιμοποιούνται σε διάφορα σημεία της εφαρμογής, οι φάκελοι εδώ γίνονται με βάση την σελίδα που βρίσκονται.
Ο φάκελος `src/contexts` περιέχει τους providers και τα contexts που αξιοποιεί η εφαρμογή μας.
Ο φάκελος `src/pages` περιέχει τις σελίδες της εφαρμογής.
Ο φάκελος `src/hooks` περιέχει τα react hooks που παρέχουν λειτουργίες και πληροφορίες στα components.
Ο φάκελος `src/theme` περιέχει οτιδήποτε σχετικό με theming(με βάση πάντα το chakra-ui) όπου προς το παρόν έχουμε ορίσει τα breakpoints που χρησιμοποιούμε στην εφαρμογή.

### How to contribute

Μπορείς να βοηθήσεις ακόμα και χωρίς να γράψεις κώδικα μεταφέροντάς μας τι θα ήταν αυτό που θα προσέθετες στην εφαρμογή ή το πρόβλημα που συνάντησες και που το συνάντησες. Η ομάδα μας θα προσπαθήσει να το λύσει το συντομότερο δυνατόν.

### Quick Start Guide

Αν έχεις κάποια συγκεκριμένη ιδέα δημιούργησε στην ομάδα στο gitlab ένα σχετικό issue και μετά δημιούργησε ένα branch από την νεότερη έκδοση του main στο οποίο και θα γράψεις τον απαραίτητο κώδικα για την επίλυση του issue. Τα commits να έχουν τίτλο fixes #{issue-number} και να περιλαμβάνουν πάντα κάποια σχετική περιγραφή. Ο κώδικας που έχεις γράψει θα πρέπει να τηρεί τα coding conventions που έχουν οριστεί για αυτό το project.

### Coding Conventions

- Δουλεύουμε με functional components στην react. Αποκλειστικά!
- Camelcase όλες οι μεταβλητές.
- Οτιδήποτε σχετίζεται με UI θα πρέπει να είναι mobile responsive. Η εφαρμογή έχει ως κύριο αποδέκτη κινητές συσκευές.
- Ευνόητος και απλός κώδικας σε κάθε παραδοτέο, κατά προτίμηση όχι υπερβολικά μεγάλα αρχεία.
- Όχι σχόλια στον κώδικα, να είναι ευανάγνωστος(περιγραφικά ονόματα μεταβλητών, συναρτήσεων και σταθερές αντί για σκέτους αριθμούς και αλφαριθμητικά)
- Αν κάποια συνάρτηση είναι αρκετά αλγοριθμική και είναι ανεξάρτητη από UI, καλό είναι να γράφεται κάποιο αντίστοιχο unit test.
- Χρήση code formatter, prettier στο VSCode, με τις αρχικές ρυθμίσεις(για τυχόν αλλαγές σε αυτές θα γίνει ενημέρωση)

### Aνάλυση Κώδικα

**Contexts**: Προς το παρόν η εφαρμογή αξιοποιεί μονάχα ένα context to `src/contexts/departmentContext.jsx` το οποίο αποθηκεύει την σχολή που έχει επιλέξει ο χρήστης, η οποία χρησιμοποιείται σε συγκεκριμένες σελίδες.

**Hooks**: Μέχρι τώρα έχει δημιουργηθεί το `src/hooks/useLocalStorage.js` που δέχεται ως παραμέτρους το όνομα της τιμής που θα αποθηκευτεί στο localStorage και μια default τιμή αν η τιμή που πάει να προσπελαστεί από το localStorage δεν βρεθεί.

**Pages**:
Γενικά κάποιος που θα εξερευνήσει την εφαρμογή μπορεί εύκολα να δει ποιο αρχείο αντιστοιχεί σε ποια σελίδα από το όνομα του αρχείου. Παρακάτω θα αναλύσουμε τις σελίδες οι οποίες έχουν μεγαλύτερο επίπεδο δυσκολίας, διότι χρησιμοποιήθηκαν έτοιμα components από Chakra-Ui.

> Σε κάποιες σελίδες όπως SchedulePage.jsx και Announcements.jsx γίνεται απλά redirect στην αντίστοιχη σελίδα του τμήματος που έχει επιλέξει ο χρήστης. Αν χρειαστεί να υλοποιηθεί κάτι παρόμοιο, τα αρχεία αυτά μπορούν να αποτελέσουν οδηγό.

- **src/pages/MapPage.jsx**

Ο χάρτης αποτελείται από διαφορετικά κτήρια τα οποία το καθένα έχει διαφορετικές τοποθεσίες(συνήθως γραφεία). Για κάθε τοποθεσία υπάρχει ένα ασανσέρ(στο ισόγειο το δείχνουμε) που σε πάει εκεί, το οποίο και δείχνουμε στον χρήστη(διότι στο παμακ τα τμήματα από τον 2ο όροφο και πάνω δεν συνδέονται, πρέπει να κατέβεις). Υπάρχουν εικόνες(urls) τα οποία μαρκάρουμε χρησιμοποιώντας την βιβλιοθήκη react-img-mapper, τα οποία είναι ο λόγος που υπάρχουν αυτά τα x,y στα δεδομένα του χάρτη στον φάκελο src/assets/data.
Τα δεδομένα του χάρτη λόγω του μεγάλου όγκου τους χρειάζονται περαιτέρω οργάνωση και γενικά ο χάρτης είναι να αντικατασταθεί εντελώς από αυτούσια εφαρμογή.
